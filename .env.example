# Example environment configuration for Adaptiv Controller GitHub MCP server
#
# Copy to .env for local development. On Render, set these in the Service
# "Environment" settings (do not commit secrets).
#
# Conventions:
# - Variables that contain secrets are intentionally blank here.
# - “Where to get it” notes are included for user-supplied values.

# ------------------------------------------------------------------------------
# REQUIRED: GitHub authentication
# ------------------------------------------------------------------------------

# GitHub token used for all GitHub API calls.
#
# Where to get it:
# - GitHub → Settings → Developer settings → Personal access tokens
#   - Fine-grained PAT recommended; grant access to the org/user + repo(s).
#   - Permissions typically needed:
#       Contents: Read/Write (for file/branch writes)
#       Pull requests: Read/Write (for PR tools)
#       Issues: Read/Write (if you use issue tools)
#       Actions: Read (if you use workflow tools)
#
GITHUB_PAT=

# Optional override for GitHub API base URL (GitHub Enterprise / proxies).
# Default: https://api.github.com
GITHUB_API_BASE=https://api.github.com

# ------------------------------------------------------------------------------
# Render Public API (optional): enables render_* observability tools
# ------------------------------------------------------------------------------

# Render API base URL.
# Default: https://api.render.com/v1
RENDER_API_BASE=https://api.render.com/v1

# Render API key used to call Render metrics/logs endpoints.
#
# Where to get it:
# - Render Dashboard → Account Settings → API Keys (create/copy key)
#
RENDER_API_KEY=

# Default Render Service ID for render_* tools.
#
# Where to get it:
# - Render Dashboard → your Service → the service id is visible in the URL and UI
#   (format like: srv-xxxxxxxxxxxx)
#
RENDER_SERVICE_ID=

# Render owner/workspace id used by Render /logs in some configurations.
#
# Where to get it:
# - If you have RENDER_SERVICE_ID, you can retrieve ownerId via Render API:
#   GET /services/{serviceId} → field: ownerId
#
RENDER_OWNER_ID=

# ------------------------------------------------------------------------------
# Controller contract / defaults
# ------------------------------------------------------------------------------

# The controller repo full_name (“owner/repo”) this server considers its own.
# Default: Proofgate-Revocations/chatgpt-mcp-github
#
# Where to get it:
# - Your GitHub repository full name (owner + repo).
GITHUB_MCP_CONTROLLER_REPO=Proofgate-Revocations/chatgpt-mcp-github

# Default controller branch for controller repo operations.
# Default: main
#
# Where to get it:
# - Your repo’s default branch name (typically "main").
GITHUB_MCP_CONTROLLER_BRANCH=main

# Optional JSON map of repo defaults to reduce API calls.
# Example: {"owner/repo": {"default_branch": "main"}}
#
# Where to get it:
# - You choose this value; it mirrors your repo settings.
GITHUB_REPO_DEFAULTS={}

# ------------------------------------------------------------------------------
# Write gate + approvals (core behavior)
# ------------------------------------------------------------------------------

# Soft write gate: controls whether *write-gated* tools are allowed.
# Default: true
#
# Where to set it:
# - Render Service → Environment → add/update this variable.
GITHUB_MCP_WRITE_ALLOWED=true

# Diagnostics toggles (optional; defaults are true)
#
# Where to set it:
# - Render Service → Environment.
GITHUB_MCP_DIAGNOSTICS=true
GITHUB_MCP_RECORD_RECENT_EVENTS=true

# Default behavior for tool metadata verbosity.
# When true, the server emits compact (summarized) tool metadata by default.
# Default: true
GITHUB_MCP_COMPACT_METADATA=true

# Recent tool event buffer capacity (optional).
# Set <= 0 to disable the buffer.
# Default: 5000
MCP_RECENT_TOOL_EVENTS_CAPACITY=5000

# ------------------------------------------------------------------------------
# Workspace and execution configuration
# ------------------------------------------------------------------------------

# Base directory for persistent workspaces used by terminal_command/run_tests.
# Default: system temp dir + "mcp-github-workspaces"
MCP_WORKSPACE_BASE_DIR=/tmp/mcp-github-workspaces

# Soft limit for terminal command length (0 disables).
# Default: 0
RUN_COMMAND_MAX_CHARS=0

# ------------------------------------------------------------------------------
# HTTP client tuning
# ------------------------------------------------------------------------------

# HTTPX timeout in seconds for GitHub/external requests.
# Default: 150
HTTPX_TIMEOUT=150

# HTTPX connection pool size.
# Defaults: 300 / 200
HTTPX_MAX_CONNECTIONS=300
HTTPX_MAX_KEEPALIVE=200

# Max concurrency for internal operations.
# Defaults: 80 / FETCH_FILES_CONCURRENCY defaults to MAX_CONCURRENCY
MAX_CONCURRENCY=80
FETCH_FILES_CONCURRENCY=80

# ------------------------------------------------------------------------------
# Git identity for commits (optional; defaults shown)
# ------------------------------------------------------------------------------

# Where to get it:
# - You choose these; they appear as commit author/committer in git history.
GIT_AUTHOR_NAME=Ally
GIT_AUTHOR_EMAIL=ally@example.com
GIT_COMMITTER_NAME=Ally
GIT_COMMITTER_EMAIL=ally@example.com

# ------------------------------------------------------------------------------
# File cache (GitHub content fetches)
# ------------------------------------------------------------------------------

# Defaults: 500 entries / 52428800 bytes (50MB)
FILE_CACHE_MAX_ENTRIES=500
FILE_CACHE_MAX_BYTES=52428800

# ------------------------------------------------------------------------------
# Tool output truncation (stdout/stderr payloads returned to connector)
# ------------------------------------------------------------------------------

# Defaults are 0 (no truncation) unless explicitly set.
TOOL_STDOUT_MAX_CHARS=0
TOOL_STDERR_MAX_CHARS=0
TOOL_STDIO_COMBINED_MAX_CHARS=0

# Unified diff logging for write tools (logs only, not tool results).
# Defaults are 0 (no limit) unless explicitly set.
WRITE_DIFF_LOG_MAX_LINES=0
WRITE_DIFF_LOG_MAX_CHARS=0

# ------------------------------------------------------------------------------
# Logging
# ------------------------------------------------------------------------------

# Default: INFO
# Valid: DEBUG, DETAILED, INFO, CHAT, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log style for stdout logs.
# Default: color
# Values: color | ansi | colored | plain
LOG_STYLE=color

# Default: "%(asctime)s | %(levelname)s | %(name)s | %(message)s"
LOG_FORMAT="%(asctime)s | %(levelname)s | %(name)s | %(message)s"

# Formatter for in-memory logs (plain text recommended).
# Default: LOG_FORMAT
LOG_FORMAT_PLAIN="%(asctime)s | %(levelname)s | %(name)s | %(message)s"

# In-memory log buffers exposed via diagnostics tools.
# Set to 0 to disable buffering.
# Defaults: 0 / 0
MCP_ERROR_LOG_CAPACITY=0
MCP_LOG_RECORD_CAPACITY=0

# ------------------------------------------------------------------------------
# Sandbox / content rewrite (optional)
# ------------------------------------------------------------------------------

# Optional base URL used when rewriting content paths for sandboxed environments.
SANDBOX_CONTENT_BASE_URL=

# ------------------------------------------------------------------------------
# Host-provided settings
# ------------------------------------------------------------------------------

# Render typically injects PORT automatically for web services.
# Set only if running locally with uvicorn.
PORT=8000
# The following variables are typically provided by the host environment and do not
# need to be set manually. They are listed here only for completeness because the
# code may reference them during certain execution contexts.
PATH=
SHELL=

# Pytest injects this when running tests.
PYTEST_CURRENT_TEST=
