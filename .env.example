# Example environment configuration for Adaptiv GitHub MCP server
#
# Copy to .env for local development. On Render, set these in the Service
# "Environment" settings (do not commit secrets).
#
# Conventions:
# - Variables that contain secrets are intentionally blank here.

# ------------------------------------------------------------------------------
# REQUIRED: GitHub authentication
# ------------------------------------------------------------------------------

# GitHub token used for all GitHub API calls.
# First configured token wins (GITHUB_PAT, GITHUB_TOKEN, GH_TOKEN, GITHUB_OAUTH_TOKEN).
GITHUB_PAT=

# Optional override for GitHub API base URL (GitHub Enterprise / proxies).
# Default: https://api.github.com
GITHUB_API_BASE=https://api.github.com

# ------------------------------------------------------------------------------
# Controller defaults
# ------------------------------------------------------------------------------

# The controller repo full_name (“owner/repo”) this server considers its own.
# Default: Proofgate-Revocations/chatgpt-mcp-github
GITHUB_MCP_CONTROLLER_REPO=Proofgate-Revocations/chatgpt-mcp-github

# Default controller branch for controller repo operations.
# Default: main
GITHUB_MCP_CONTROLLER_BRANCH=main

# Optional JSON map of repo defaults to reduce API calls.
# Example: {"owner/repo": {"default_branch": "main"}}
GITHUB_REPO_DEFAULTS={}

# ------------------------------------------------------------------------------
# Write gate + approvals (core behavior)
# ------------------------------------------------------------------------------

# Controls whether write actions are auto-approved.
# - true: write tools are auto-approved
# - false: clients should prompt before invoking write tools
# Default: true
GITHUB_MCP_WRITE_ALLOWED=true

# Default tool metadata verbosity.
# When true (or "1"), the server emits compact (summarized) tool metadata by default.
# Default: true
GITHUB_MCP_COMPACT_METADATA_DEFAULT=true

# Optional host allowlist (comma-separated). Leave empty to disable host checks.
ALLOWED_HOSTS=

# ------------------------------------------------------------------------------
# Workspace configuration
# ------------------------------------------------------------------------------

# Base directory for persistent workspace clones.
# Default: system temp dir + "mcp-github-workspaces"
MCP_WORKSPACE_BASE_DIR=/tmp/mcp-github-workspaces

# Timeout (seconds) for applying diffs into the workspace clone.
MCP_WORKSPACE_APPLY_DIFF_TIMEOUT_SECONDS=0

# ------------------------------------------------------------------------------
# HTTP client tuning
# ------------------------------------------------------------------------------

# HTTPX timeout in seconds for GitHub/external requests.
# Default: 150
HTTPX_TIMEOUT=150

# HTTPX connection pool size.
# Defaults: 300 / 200
HTTPX_MAX_CONNECTIONS=300
HTTPX_MAX_KEEPALIVE=200

# Max concurrency for internal operations.
# Defaults: 80 / FETCH_FILES_CONCURRENCY defaults to MAX_CONCURRENCY
MAX_CONCURRENCY=80
FETCH_FILES_CONCURRENCY=80

# ------------------------------------------------------------------------------
# GitHub rate limiting and search pacing
# ------------------------------------------------------------------------------

GITHUB_RATE_LIMIT_RETRY_BASE_DELAY_SECONDS=0
GITHUB_RATE_LIMIT_RETRY_MAX_ATTEMPTS=0
GITHUB_RATE_LIMIT_RETRY_MAX_WAIT_SECONDS=0
GITHUB_SEARCH_MIN_INTERVAL_SECONDS=0

# ------------------------------------------------------------------------------
# File cache (GitHub content fetches)
# ------------------------------------------------------------------------------

# Defaults: 500 entries / 52428800 bytes (50MB)
FILE_CACHE_MAX_ENTRIES=500
FILE_CACHE_MAX_BYTES=52428800

# ------------------------------------------------------------------------------
# Logging
# ------------------------------------------------------------------------------

# Default: INFO
LOG_LEVEL=INFO

# Default: "%(asctime)s | %(levelname)s | %(name)s | %(message)s"
LOG_FORMAT="%(asctime)s | %(levelname)s | %(name)s | %(message)s"

# ------------------------------------------------------------------------------
# Sandbox / content rewrite (optional)
# ------------------------------------------------------------------------------

# Optional base URL used when rewriting content paths for sandboxed environments.
SANDBOX_CONTENT_BASE_URL=

# ------------------------------------------------------------------------------
# Host-provided settings
# ------------------------------------------------------------------------------

# Render injects PORT automatically for web services.
# Set only if running locally with uvicorn.
PORT=8000
