# Render Blueprint (Infrastructure as Code)
# Reference:
# - https://render.com/docs/blueprint-spec
# - https://render.com/docs/infrastructure-as-code
#
# Goal: maximize operational value (reproducible deploys, health checks, persistent workspace).

previews:
  generation: off

services:
  - type: web
    name: chatgpt-mcp-github
    runtime: docker

    # Deterministic deployment defaults.
    region: oregon
    plan: starter
    numInstances: 1

    branch: main
    autoDeployTrigger: commit

    dockerfilePath: ./Dockerfile
    dockerContext: ./

    # Health check endpoint for zero-downtime deploys.
    healthCheckPath: /healthz

    # Persist workspace across deploys to speed up clone/reset + tool execution.
    disk:
      name: workspace
      mountPath: /workspace
      sizeGB: 10

    envVars:
      - key: LOG_LEVEL
        value: INFO
      - key: MCP_WORKSPACE_BASE_DIR
        value: /workspace
      - key: UVICORN_ACCESS_LOG
        value: "1"
